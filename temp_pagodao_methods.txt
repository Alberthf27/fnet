// ============================================
// AGREGAR ESTOS MÉTODOS AL FINAL DE PagoDAO.java
// ANTES DEL ÚLTIMO }
// ============================================

    /**
     * Obtiene información de la última factura generada para una suscripción.
     * Retorna formato: "del mes de Enero 2026 (02 Ene - 02 Feb)"
     */
    public String obtenerUltimaFacturaInfo(int idSuscripcion) {
        String sql = "SELECT periodo_mes, rango_periodo FROM factura " +
                     "WHERE id_suscripcion = ? ORDER BY id_factura DESC LIMIT 1";
        
        try (Connection con = bd.Conexion.getConexion();
             PreparedStatement ps = con.prepareStatement(sql)) {
            ps.setInt(1, idSuscripcion);
            ResultSet rs = ps.executeQuery();
            
            if (rs.next()) {
                String periodoMes = rs.getString("periodo_mes");
                String rangoPeriodo = rs.getString("rango_periodo");
                return "del mes de " + periodoMes + " (" + rangoPeriodo + ")";
            }
        } catch (SQLException e) {
            System.err.println("Error obteniendo info de factura: " + e.getMessage());
        }
        
        return "del mes actual";
    }

    /**
     * Obtiene el detalle de todas las facturas pendientes de una suscripción.
     * Retorna formato: "• Enero 2026 (02 Ene - 02 Feb): S/. 50.00\n• Febrero 2026..."
     */
    public String obtenerFacturasPendientesDetalle(int idSuscripcion) {
        String sql = "SELECT periodo_mes, rango_periodo, monto FROM factura " +
                     "WHERE id_suscripcion = ? AND estado = 1 " +
                     "ORDER BY fecha_emision ASC";
        
        StringBuilder detalle = new StringBuilder();
        
        try (Connection con = bd.Conexion.getConexion();
             PreparedStatement ps = con.prepareStatement(sql)) {
            ps.setInt(1, idSuscripcion);
            ResultSet rs = ps.executeQuery();
            
            while (rs.next()) {
                String periodoMes = rs.getString("periodo_mes");
                String rangoPeriodo = rs.getString("rango_periodo");
                double monto = rs.getDouble("monto");
                
                detalle.append("• ").append(periodoMes)
                       .append(" (").append(rangoPeriodo).append("): S/. ")
                       .append(String.format("%.2f", monto))
                       .append("\n");
            }
        } catch (SQLException e) {
            System.err.println("Error obteniendo facturas pendientes: " + e.getMessage());
        }
        
        return detalle.toString().trim();
    }
